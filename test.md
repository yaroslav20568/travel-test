# План тестирования

## Технологии для тестирования

### Основные инструменты

- **Jest** - тестовый фреймворк для JavaScript/TypeScript
- **React Testing Library** - библиотека для тестирования React компонентов
- **@testing-library/jest-dom** - дополнительные матчеры для DOM элементов
- **@testing-library/user-event** - симуляция пользовательских взаимодействий
- **MSW (Mock Service Worker)** - мокирование HTTP запросов для тестирования API
- **@tanstack/react-query-testing** - утилиты для тестирования React Query
- **@testing-library/react-hooks** - тестирование кастомных хуков (если требуется)

### Дополнительные инструменты

- **jest-environment-jsdom** - окружение для тестирования DOM в Jest
- **@testing-library/react** - рендеринг React компонентов в тестах
- **@testing-library/next** - утилиты для тестирования Next.js компонентов (если доступно)

## Тест-кейсы

### 4. Кастомные хуки

#### Тест-кейсы для `useInfiniteScroll`

- **TC-HOOK-001**: Инициализация хука
  - Проверка начального состояния
  - Проверка загрузки первой страницы

- **TC-HOOK-002**: Загрузка следующих страниц
  - Проверка функции `fetchNextPage`
  - Проверка обновления `hasNextPage`
  - Проверка накопления данных

- **TC-HOOK-003**: Определение последней страницы
  - Проверка `hasNextPage = false` при пустом ответе
  - Проверка `hasNextPage = false` при количестве меньше лимита

- **TC-HOOK-004**: Передача параметров запроса
  - Проверка передачи дополнительных параметров в `queryFn`

#### Тест-кейсы для `useIntersectionObserver`

- **TC-HOOK-007**: Наблюдение за элементами
  - Проверка срабатывания callback при появлении элемента
  - Проверка срабатывания callback при исчезновении элемента
  - Проверка работы с опциями observer

### 5. UI компоненты

#### Тест-кейсы для `ServiceCard`

- **TC-UI-001**: Отображение карточки услуги
  - Проверка отображения названия услуги
  - Проверка отображения цены в правильном формате
  - Проверка наличия кнопки "Add to cart"

- **TC-UI-002**: Добавление в корзину
  - Проверка вызова `addItem` при клике на кнопку
  - Проверка изменения текста кнопки на "Already in cart"
  - Проверка блокировки кнопки при товаре в корзине

- **TC-UI-003**: Состояние товара в корзине
  - Проверка отображения "Already in cart" для товара в корзине
  - Проверка отображения "Add to cart" для товара не в корзине

#### Тест-кейсы для `CartItem`

- **TC-UI-004**: Отображение элемента корзины
  - Проверка отображения названия товара
  - Проверка отображения цены в правильном формате
  - Проверка наличия кнопки "Remove"

- **TC-UI-005**: Удаление из корзины
  - Проверка вызова `removeItem` при клике на кнопку
  - Проверка передачи правильного ID

#### Тест-кейсы для `CartSummary`

- **TC-UI-006**: Отображение итоговой суммы
  - Проверка отображения суммы для пустой корзины
  - Проверка отображения суммы для корзины с товарами
  - Проверка форматирования цены
  - Проверка анимации изменения суммы

- **TC-UI-007**: Кнопка оформления заказа
  - Проверка блокировки кнопки при пустой корзине
  - Проверка активности кнопки при наличии товаров
  - Проверка вызова обработчика при клике

#### Тест-кейсы для `Cart`

- **TC-UI-008**: Отображение корзины (десктоп)
  - Проверка отображения корзины на десктопе
  - Проверка отсутствия overlay на десктопе

- **TC-UI-009**: Отображение корзины (мобильная)
  - Проверка отображения drawer на мобильном
  - Проверка overlay при открытой корзине
  - Проверка закрытия при клике на overlay

- **TC-UI-010**: Состояние пустой корзины
  - Проверка отображения `CartEmpty` при пустой корзине
  - Проверка анимации появления/исчезновения

- **TC-UI-011**: Состояние корзины с товарами
  - Проверка отображения `CartList` при наличии товаров
  - Проверка отображения `CartHeader` и `CartSummary`

#### Тест-кейсы для `CartList`

- **TC-UI-012**: Отображение списка товаров
  - Проверка отображения всех товаров из корзины
  - Проверка корректного количества элементов

#### Тест-кейсы для `CartHeader`

- **TC-UI-013**: Заголовок корзины
  - Проверка отображения заголовка
  - Проверка кнопки закрытия на мобильной версии
  - Проверка отсутствия кнопки закрытия на десктопе

#### Тест-кейсы для `CartEmpty`

- **TC-UI-014**: Пустая корзина
  - Проверка отображения сообщения о пустой корзине

#### Тест-кейсы для `ServicesList`

- **TC-UI-015**: Отображение списка услуг
  - Проверка отображения загруженных услуг
  - Проверка отображения лоадера при загрузке

- **TC-UI-016**: Бесконечная прокрутка
  - Проверка загрузки следующей страницы при скролле
  - Проверка отображения лоадера при загрузке следующей страницы
  - Проверка остановки загрузки при достижении конца

- **TC-UI-017**: Обработка ошибок
  - Проверка отображения ошибки при неудачной загрузке

#### Тест-кейсы для `Button`

- **TC-UI-018**: Базовое отображение кнопки
  - Проверка отображения текста
  - Проверка обработчика клика

- **TC-UI-019**: Состояния кнопки
  - Проверка disabled состояния
  - Проверка размера кнопки (size prop)
  - Проверка fullWidth варианта

#### Тест-кейсы для `Loader`

- **TC-UI-020**: Отображение лоадера
  - Проверка видимости лоадера
  - Проверка анимации

### 6. Интеграционные тесты

#### Тест-кейсы для потока добавления в корзину

- **TC-INT-001**: Полный поток добавления товара
  - Открытие страницы услуг
  - Клик на "Add to cart" в карточке услуги
  - Проверка обновления состояния корзины
  - Проверка изменения кнопки на "Already in cart"
  - Проверка отображения товара в корзине

#### Тест-кейсы для потока удаления из корзины

- **TC-INT-002**: Полный поток удаления товара
  - Добавление товара в корзину
  - Открытие корзины
  - Клик на "Remove" у товара
  - Проверка удаления из корзины
  - Проверка обновления итоговой суммы

#### Тест-кейсы для бесконечной прокрутки

- **TC-INT-003**: Загрузка и отображение услуг
  - Загрузка первой страницы услуг
  - Скролл до конца списка
  - Проверка загрузки следующей страницы
  - Проверка накопления данных

### 7. E2E тесты (опционально)

#### Тест-кейсы для пользовательских сценариев

- **TC-E2E-001**: Просмотр и добавление услуг
  - Открытие главной страницы
  - Прокрутка списка услуг
  - Добавление нескольких услуг в корзину
  - Проверка содержимого корзины

- **TC-E2E-002**: Управление корзиной
  - Добавление услуг
  - Удаление услуг
  - Проверка итоговой суммы
  - Очистка корзины

- **TC-E2E-003**: Адаптивность
  - Проверка работы на мобильной версии
  - Проверка работы на десктопе
  - Проверка переключения между режимами

## Приоритеты тестирования

### Высокий приоритет

- Компоненты корзины (TC-UI-004 - TC-UI-014)
- Интеграционные тесты основных потоков (TC-INT-001, TC-INT-002)

### Средний приоритет

- Хук бесконечной прокрутки (TC-HOOK-001 - TC-HOOK-004)
- Компоненты списка услуг (TC-UI-015 - TC-UI-017)
- Интеграционный тест бесконечной прокрутки (TC-INT-003)

### Низкий приоритет

- UI компоненты общего назначения (TC-UI-018 - TC-UI-020)
- E2E тесты (TC-E2E-001 - TC-E2E-003)
